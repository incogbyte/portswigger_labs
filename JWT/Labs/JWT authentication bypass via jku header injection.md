
This lab uses a JWT-based mechanism for handling sessions. The server supports the `jku` parameter in the JWT header. However, it fails to check whether the provided URL belongs to a trusted domain before fetching the key.

To solve the lab, forge a JWT that gives you access to the admin panel at `/admin`, then delete the user `carlos`.

You can log in to your own account using the following credentials: `wiener:peter`



* Create new RSA Key
![](../img/Pasted_image_20230524104500.png)

* Copy Key Public Key as JWK
  
  ![](../img/Pasted_image_20230524104653.png)

* Paste at exploit server ( inside your lab URL) 
![](../img/Pasted_image_20230524104827.png)
* Change the kid with the KID generate at previous step
![](../img/Pasted_image_20230524105124.png)
* Set a new jku parameter
![](../img/Pasted_image_20230524105438.png)
* Click attack and sign the JWT
![](../img/Pasted_image_20230524105552.png)

* Change de KID with the KID generated by our previous payload and the JKU with the url of exploit server
![](../img/Pasted_image_20230524112653.png)
* Lab solved

![](../img/Pasted_image_20230524112829.png)
